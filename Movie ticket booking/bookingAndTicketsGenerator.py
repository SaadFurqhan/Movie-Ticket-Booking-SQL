from random import randint
from random import shuffle
def zeroPad(s,dlen):
	st = ''
	for i in range(dlen-len(s)):
		st+='0'
	st+=s
	return st
def ticketListAdd(gtickets,stickets,showid,Bid,gcost,scost,gt_left,st_left):
	l = []
	for i in range(gtickets):
		s = "G"
		s+=zeroPad(str(gt_left - i),4);
		l.append(s)
	for i in range(stickets):
		s = "S"
		s+=zeroPad(str(st_left-i),4);
		l.append(s)
	l = ["'"+i + showid.lstrip("'") for i in l]
	tlist = [];

	for i in l:
		if i[1] == 'G':
			clss = "'GLD'"
			cost = gcost;

		else:
			clss = "'SLV'"
			cost = scost
		s = "(" + i + ", " + Bid + ", " + clss + ", " + cost + ")"
		tlist.append(s);
		#print(s);
	return tlist	

users = """
('100', 'Amit', 'Sinha', 'amitsinhT04@gmail.com', 35, '9846273634'),
('101', 'Raghav', 'Seth', 'seth.raghav987@gmail.com', 26, '7845279834'),
('102', 'Anjali', 'Gupta', 'anjali23g@gmail.com', 30, '8849273345'),
('103', 'Joy', 'Mathew', 'jmathew.123@gmail.com', 27, '9000567890'),
('104', 'Sudha', 'Sunil', 'sudha_sunil07@gmail.com', 47, '8874323461'),
('105', 'Ajay', 'Kumar', 'kumarajayv56@gmail.com', 19, '9078985643'),
('106', 'Vikram', 'Joshi', 'jvikram.89@gmail.com', 23, '7750912345'),
('107', 'Komal', 'Agarwal', 'komal.agarwal87@gmail.com', 15, '9345687654'),
('108', 'Maitri', 'Shah', 'maitrishahj1@gmail.com', 32, '9922345016'),
('109', 'Bhavya', 'Shastri', 'bhavyashastri@gmail.com', 25, '8567409098'),
('110', 'Preeti', 'Jain', 'preeti.jain@gmail.com', 18, '7765433211'),
('111',	'Shreya', 'Rathod','rathod_shreya@gmail.com',38,'9800215673'),
('112',	'Aditya', 'Rajesh','adityarajesh2902@gmail.com',21,'9108996762'),
('113',	'Keerti', 'Srivatsan','keertisri@gmail.com',25,'7707378654'),
('114',	'Rahul', 'Raghav','rahulrag@gmail.com',23,'9591990037'),
('115',	'Shrushti', 'Singh','shrushtikaul@gmail.com',19,'9900554017'),
('116',	'Mona', 'Mohammed','monaraisa@gmail.com',23,'9591670037'),
('117',	'Anushka', 'Sharma','sharmaanushka@gmail.com',40,'9902432497'),
('118',	'Yohanan', 'Veerappan','yohanv@gmail.com',44,'8231239804'),
('119',	'Kamala', 'Raghavendran','kamalag@gmail.com',32,'9594390037'),
('120',	'Janice', 'Fernandes','janicefernandes@gmail.com',38,'9325880785'),
('121',	'Sachin', 'Suresh','sachin1995@gmail.com',23,'9325880785'),
('122',	'Utham', 'Aiyappa','utham10@gmail.com',21,'8581654798'),
('123',	'Pranav', 'Gowda','pranavgowda06@gmail.com',37,'8846085689'),
('124',	'Krita', 'Prabhu','prabhukrita@gmail.com',20,'9098107054'),
('125',	'Aadrika', 'Bhandarkar','aadrikabhandarkar@gmail.com',28,'9895287453'),
('126',	'Sulohit', 'Avvaru','avvarusulohit1996@gmail.com',22,'7180867407'),
('127',	'Shriya', 'Bhimanadula','shriyab@gmail.com',35,'9055932134'),
('128',	'Ashmita', 'Rao','ashmitarao@gmail.com',27,'7191088921'),
('129',	'Nusaiba', 'Mehrunisa','nusaibafatima@gmail.com',24,'8731990037');
"""


shows = """
('SHT0110001', '09:00:00 AM', '4/4/18', 20, 60, 400, 350, 'T011', '001'),
('SHT0120001', '09:00:00 AM', '4/4/18', 20, 60, 400, 350, 'T012', '002'),
('SHT0130001', '09:00:00 AM', '4/4/18', 20, 60, 400, 350, 'T013', '003'),
('SHT0140001', '09:00:00 AM', '4/4/18', 20, 60, 400, 350, 'T014', '004'),
('SHT0210001', '09:00:00 AM', '4/4/18', 22, 64, 395, 325, 'T021', '005'),
('SHT0220001', '09:00:00 AM', '4/4/18', 22, 64, 395, 325, 'T022', '006'),
('SHT0230001', '09:00:00 AM', '4/4/18', 22, 64, 395, 325, 'T023', '007'),
('SHT0240001', '09:00:00 AM', '4/4/18', 22, 64, 395, 325, 'T024', '008'),
('SHT0310001', '09:00:00 AM', '4/4/18', 20, 50, 425, 350, 'T031', '009'),
('SHT0320001', '09:00:00 AM', '4/4/18', 20, 50, 425, 350, 'T032', '010'),
('SHT0330001', '09:00:00 AM', '4/4/18', 20, 50, 425, 350, 'T033', '011'),
('SHT0110002', '04:20:00 PM', '4/4/18', 20, 60, 400, 350, 'T011', '012'),
('SHT0120002', '04:20:00 PM', '4/4/18', 20, 60, 400, 350, 'T012', '013'),
('SHT0130002', '04:20:00 PM', '4/4/18', 20, 60, 400, 350, 'T013', '014'),
('SHT0140002', '04:20:00 PM', '4/4/18', 20, 60, 400, 350, 'T014', '015'),
('SHT0210002', '04:20:00 PM', '4/4/18', 22, 64, 395, 325, 'T021', '016'),
('SHT0220002', '04:20:00 PM', '4/4/18', 22, 64, 395, 325, 'T022', '001'),
('SHT0230002', '04:20:00 PM', '4/4/18', 22, 64, 395, 325, 'T023', '002'),
('SHT0240002', '04:20:00 PM', '4/4/18', 22, 64, 395, 325, 'T024', '003'),
('SHT0310002', '04:20:00 PM', '4/4/18', 20, 50, 425, 350, 'T031', '004'),
('SHT0320002', '04:20:00 PM', '4/4/18', 20, 50, 425, 350, 'T032', '005'),
('SHT0330002', '04:20:00 PM', '4/4/18', 20, 50, 425, 350, 'T033', '006'),
('SHT0110003', '07:30:00 PM', '4/4/18', 20, 60, 400, 350, 'T011', '007'),
('SHT0120003', '07:30:00 PM', '4/4/18', 20, 60, 400, 350, 'T012', '008'),
('SHT0130003', '07:30:00 PM', '4/4/18', 20, 60, 400, 350, 'T013', '009'),
('SHT0140003', '07:30:00 PM', '4/4/18', 20, 60, 400, 350, 'T014', '010'),
('SHT0210003', '07:30:00 PM', '4/4/18', 22, 64, 395, 325, 'T021', '011'),
('SHT0220003', '07:30:00 PM', '4/4/18', 22, 64, 395, 325, 'T022', '012'),
('SHT0230003', '07:30:00 PM', '4/4/18', 22, 64, 395, 325, 'T023', '013'),
('SHT0240003', '07:30:00 PM', '4/4/18', 22, 64, 395, 325, 'T024', '014'),
('SHT0310003', '07:30:00 PM', '4/4/18', 20, 50, 425, 350, 'T031', '015'),
('SHT0320003', '07:30:00 PM', '4/4/18', 20, 50, 425, 350, 'T032', '016'),
('SHT0330003', '07:30:00 PM', '4/4/18', 20, 50, 425, 350, 'T033', '001'),
('SHT0110004', '09:00:00 AM', '4/4/18', 20, 60, 400, 350, 'T011', '002'),
('SHT0120004', '09:00:00 AM', '4/4/18', 20, 60, 400, 350, 'T012', '003'),
('SHT0130004', '09:00:00 AM', '4/4/18', 20, 60, 400, 350, 'T013', '004'),
('SHT0140004', '09:00:00 AM', '4/4/18', 20, 60, 400, 350, 'T014', '005'),
('SHT0210004', '09:00:00 AM', '4/4/18', 22, 64, 395, 325, 'T021', '006'),
('SHT0220004', '09:00:00 AM', '4/4/18', 22, 64, 395, 325, 'T022', '007'),
('SHT0230004', '09:00:00 AM', '4/4/18', 22, 64, 395, 325, 'T023', '008'),
('SHT0240004', '09:00:00 AM', '4/4/18', 22, 64, 395, 325, 'T024', '009'),
('SHT0310004', '09:00:00 AM', '4/4/18', 20, 50, 425, 350, 'T031', '010'),
('SHT0320004', '09:00:00 AM', '4/4/18', 20, 50, 425, 350, 'T032', '011'),
('SHT0330004', '09:00:00 AM', '4/4/18', 20, 50, 425, 350, 'T033', '012'),
('SHT0110005', '04:20:00 PM', '4/4/18', 20, 60, 400, 350, 'T011', '013'),
('SHT0120005', '04:20:00 PM', '4/4/18', 20, 60, 400, 350, 'T012', '014'),
('SHT0130005', '04:20:00 PM', '4/4/18', 20, 60, 400, 350, 'T013', '015'),
('SHT0140005', '04:20:00 PM', '4/4/18', 20, 60, 400, 350, 'T014', '016'),
('SHT0210005', '04:20:00 PM', '4/4/18', 22, 64, 395, 325, 'T021', '001'),
('SHT0220005', '04:20:00 PM', '4/4/18', 22, 64, 395, 325, 'T022', '002'),
('SHT0230005', '04:20:00 PM', '4/4/18', 22, 64, 395, 325, 'T023', '003'),
('SHT0240005', '04:20:00 PM', '4/4/18', 22, 64, 395, 325, 'T024', '004'),
('SHT0310005', '04:20:00 PM', '4/4/18', 20, 50, 425, 350, 'T031', '005'),
('SHT0320005', '04:20:00 PM', '4/4/18', 20, 50, 425, 350, 'T032', '006'),
('SHT0330005', '04:20:00 PM', '4/4/18', 20, 50, 425, 350, 'T033', '007'),
('SHT0110006', '07:30:00 PM', '4/4/18', 20, 60, 400, 350, 'T011', '008'),
('SHT0120006', '07:30:00 PM', '4/4/18', 20, 60, 400, 350, 'T012', '009'),
('SHT0130006', '07:30:00 PM', '4/4/18', 20, 60, 400, 350, 'T013', '010'),
('SHT0140006', '07:30:00 PM', '4/4/18', 20, 60, 400, 350, 'T014', '011'),
('SHT0210006', '07:30:00 PM', '4/4/18', 22, 64, 395, 325, 'T021', '012'),
('SHT0220006', '07:30:00 PM', '4/4/18', 22, 64, 395, 325, 'T022', '013'),
('SHT0230006', '07:30:00 PM', '4/4/18', 22, 64, 395, 325, 'T023', '014'),
('SHT0240006', '07:30:00 PM', '4/4/18', 22, 64, 395, 325, 'T024', '015'),
('SHT0310006', '07:30:00 PM', '4/4/18', 20, 50, 425, 350, 'T031', '016'),
('SHT0320006', '07:30:00 PM', '4/4/18', 20, 50, 425, 350, 'T032', '001'),
('SHT0330006', '07:30:00 PM', '4/4/18', 20, 50, 425, 350, 'T033', '002'),
('SHT0110007', '09:00:00 AM', '5/4/18', 20, 60, 400, 350, 'T011', '003'),
('SHT0120007', '09:00:00 AM', '5/4/18', 20, 60, 400, 350, 'T012', '004'),
('SHT0130007', '09:00:00 AM', '5/4/18', 20, 60, 400, 350, 'T013', '005'),
('SHT0140007', '09:00:00 AM', '5/4/18', 20, 60, 400, 350, 'T014', '006'),
('SHT0210007', '09:00:00 AM', '5/4/18', 22, 64, 395, 325, 'T021', '007'),
('SHT0220007', '09:00:00 AM', '5/4/18', 22, 64, 395, 325, 'T022', '008'),
('SHT0230007', '09:00:00 AM', '5/4/18', 22, 64, 395, 325, 'T023', '009'),
('SHT0240007', '09:00:00 AM', '5/4/18', 22, 64, 395, 325, 'T024', '010'),
('SHT0310007', '09:00:00 AM', '5/4/18', 20, 50, 425, 350, 'T031', '011'),
('SHT0320007', '09:00:00 AM', '5/4/18', 20, 50, 425, 350, 'T032', '012'),
('SHT0330007', '09:00:00 AM', '5/4/18', 20, 50, 425, 350, 'T033', '013'),
('SHT0110008', '04:20:00 PM', '6/4/18', 20, 60, 400, 350, 'T011', '014'),
('SHT0120008', '04:20:00 PM', '6/4/18', 20, 60, 400, 350, 'T012', '015'),
('SHT0130008', '04:20:00 PM', '6/4/18', 20, 60, 400, 350, 'T013', '016'),
('SHT0140008', '04:20:00 PM', '6/4/18', 20, 60, 400, 350, 'T014', '001'),
('SHT0210008', '04:20:00 PM', '6/4/18', 22, 64, 395, 325, 'T021', '002'),
('SHT0220008', '04:20:00 PM', '6/4/18', 22, 64, 395, 325, 'T022', '003'),
('SHT0230008', '04:20:00 PM', '6/4/18', 22, 64, 395, 325, 'T023', '004'),
('SHT0240008', '04:20:00 PM', '6/4/18', 22, 64, 395, 325, 'T024', '005'),
('SHT0310008', '04:20:00 PM', '6/4/18', 20, 50, 425, 350, 'T031', '006'),
('SHT0320008', '04:20:00 PM', '6/4/18', 20, 50, 425, 350, 'T032', '007'),
('SHT0330008', '04:20:00 PM', '6/4/18', 20, 50, 425, 350, 'T033', '008'),
('SHT0110009', '07:30:00 PM', '6/4/18', 20, 60, 400, 350, 'T011', '009'),
('SHT0120009', '07:30:00 PM', '6/4/18', 20, 60, 400, 350, 'T012', '010'),
('SHT0130009', '07:30:00 PM', '6/4/18', 20, 60, 400, 350, 'T013', '011'),
('SHT0140009', '07:30:00 PM', '6/4/18', 20, 60, 400, 350, 'T014', '012'),
('SHT0210009', '07:30:00 PM', '6/4/18', 22, 64, 395, 325, 'T021', '013'),
('SHT0220009', '07:30:00 PM', '6/4/18', 22, 64, 395, 325, 'T022', '014'),
('SHT0230009', '07:30:00 PM', '6/4/18', 22, 64, 395, 325, 'T023', '015'),
('SHT0240009', '07:30:00 PM', '6/4/18', 22, 64, 395, 325, 'T024', '016'),
('SHT0310009', '07:30:00 PM', '6/4/18', 20, 50, 425, 350, 'T031', '001'),
('SHT0320009', '07:30:00 PM', '6/4/18', 20, 50, 425, 350, 'T032', '002'),
('SHT0330009', '07:30:00 PM', '6/4/18', 20, 50, 425, 350, 'T033', '003');"""

shows = shows.split('\n');
shows = [i.rstrip(",") for i in shows]
shows.pop(0);
shows.pop(-1)

users = users.split('\n');
users = [i.rstrip(",") for i in users]
users = [i.rstrip(")") for i in users ]
users = [i.lstrip("(") for i in users]
users.pop(0);
users.pop(-1)
bookings = []
id_count = 0;
finalBB = 'INSERT into booking values'
finalTB = 'INSERT into ticket values'
tcount = 0;
bcount = 0
mx = 0
#print(users)
ticketList = []
for i in shows:
	ulist = [i for i in range(0,len(users))]
	i = i.rstrip(')');
	i = i.lstrip('(');
	showData = i.split(',');
	gt_left = int(showData[3]) ;
	st_left = + int(showData[4]);
	while(gt_left + st_left > 6 and len(ulist)>0):
		gtickets = 0;
		if(gt_left >st_left//2):
			if gt_left>0:
				gtickets = randint(1,min(gt_left,6)) ;
			else:
				gtickets = 0;
		if st_left>0:	
			stickets = randint(1,min(st_left,6));
		else:
			stickets = 0	
		cost = int(showData[5])*gtickets + int(showData[6])*stickets
		uNo = randint(0,len(ulist)-1);
		userData = users[ulist[uNo]].split(',');
		ulist.pop(uNo)
		Name = "'" + userData[1].strip().strip("'") + " " + userData[2].strip().strip("'") +"'";
		cardNo = randint(1000000000000000,10000000000000000);
		userid = userData[0].strip("'");
		showid = showData[0]
		bookingid = "'BK" + userid + zeroPad(str(id_count),5) + "'";
		output = "(" + bookingid  + ', ' + str(gtickets + stickets)  + ', ' + str(cost)+ ', ' +"'"+str(cardNo)+"'"+ ', ' + Name + ', ' + userid + ', ' +  showid + ")"
		ticketList = ticketListAdd(gtickets,stickets,showid,bookingid,showData[5],showData[6],gt_left,st_left)
		finalB = finalBB + output + ";"
		print(finalB)
		for i in ticketList:
			finalT = finalTB + i;
			finalT+=";" 
			print(finalT);
			tcount +=1
		gt_left -= gtickets;
		st_left -= stickets;
		#print("\n",gt_left,st_left,"\n");
		id_count+=1;
		#bcount +=1
	"""
	m = st_left + gt_left
	if(m>mx):
		mx = m;

	print("\n",st_left, gt_left,"\n")
	"""
#print("bookings:",bcount,"tickets:",tcount, mx);

#shuffle(bookings)
#shuffle(ticketList)		

	
#print(len(bookings),len(ticketList))


